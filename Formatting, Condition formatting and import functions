Formatting, Conditional Formatting, and Important Functions. 
We will learn about custom formatting, how to use it, and implement logical, statistical, and mathematical functions. 
we need to differentiate the sales value from a given dataset as above target, below target, and met target. 
As a dataset can be huge and complex, differentiating each value manually would consume a lot of effort and time. 
we can use Excel features such as, Formatting and Conditional Formatting, which will enable us to perform this task easily. 
Formatting, The right formatting technique applied to the worksheets can help users present the data efficiently. 
Conditional Formatting, helps us to visually explore and analyze data, detect critical issues, and identify patterns and trends. 
Conditional Formatting helps to add patterns and trends to the raw information, using different colors, icons, formulas, etc. 
Sometimes we also need to perform mathematical operations and calculations within our dataset. 
In such cases, Excel provides a large number of logical, statistical, and mathematical functions such as, VLOOKUP, HLOOKUP, IF, 
NOT, RANK, QUARTILE, and many more, that can help the users to perform calculations ranging, from basic to complex operations.
These inbuilt functions help us manage data, and perform descriptive statistical analysis. 
Excel also offers a wide range of important formulas, that help perform many common tasks. These formulas may be as simple 
as basic addition, or could be a complex combination of indult Excel functions.  

Custom formatting.
The worksheets appear more polished and easy to read if proper formatting techniques are applied to it. We can format the 
cells in Microsoft Excel manually by selecting the font, color, font size, background colors, and borders. 
We can also use numerous predefined table styles or quick styles to format a table automatically. 
This is the basic formatting in Excel. If these built-in functions do not meet our needs or display the data in the format that 
we require, we can create our own custom format. In this topic, we will focus on custom formatting in Excel. Let's say we want to 
display 1,532,000 as 1.53m, or the 1st of January 2016 date, with the weekday as the 1st Friday, January, 2016. Here, we can use 
the custom formatting feature of Excel. Let's see how we can accomplish this in Excel.
T: Added to Selection. Press [CTRL + S] to save as a note

1. Example.
we shall consider the following fields from our master table. Dates, order ID, product, salesman, region, number of customers, 
net sales, and profit and loss. Here in the given worksheet, we have a column named net sales. Suppose we want to display the 
values of net sales in terms of thousands. For example, 7,164 should be displayed as 7.16 K.
Select the entire column for net sales.
Under the home tab, click the dropdown present in the numbers panel. Select the option more number formats.
The format cells dialog box appears. From the category list, select the type as custom.
In the type text box, enter number, comma, number, number, zero, decimal, zero, zero, comma, open double quote, capital K, 
close double quote. Here, number is the digit holder with thousand comma separation. Each comma after decimal zero zero indicates 
divide value by 1000. The two zeros after decimal point indicate the number of values after decimal places. The K component displays 
a literal K character to denote thousands. Here we can see the preview in a sample box. The value shown is 6.53 K. Finally, click the 
okay button. The values in column net sales are now displayed in terms of thousands.

2. Example of date formatting and the column dates. We have a date value written as 1st Jan, 2012. We want to display it as 1st Sunday,
Jan, 2012. First select a column containing dates. Under the home tab, click the dropdown present in the numbers panel. 
Select the option more number formats. The format cells dialog box appears. From the category list, select the type as custom.
In the type text box, enter D D dash D D D D dash M M M dash Y Y. The first two D D's are the date. The next four D D D D is for 
weekday, say Thursday. Then M M M is for the month in short form. And Y Y is for year. We can see in the preview in the sample box,
the value shown is 1, Sunday, Jan 12. Finally, click on okay.
Thus the custom formatting helps us in changing the appearance of the cell value, according to our needs.

Conditional formatting. The worksheet may contain thousands of rows of data. By simply examining the raw information, 
it would be difficult to see patterns and trends. Conditional formatting helps us visualize data that make worksheets easier to
understand. It quickly highlights important information in the spreadsheet by using colors, icons, and data bars. It changes the
appearance of one or more cells when the cell value meets certain criteria. To do this, we need to create a conditional formatting rule.
For example, a conditional formatting rule can be, if value is greater than 5,000, color the cell yellow. By applying this rule,
we are able to quickly see which cells contain values that are greater than 5,000. Let us understand this with the help of examples.
Now that we have looked at the definition of conditional formatting, let us look at an example. Consider the given sales table, 
which depicts the amount of sales done by each salesman. Here, we want to highlight the duplicate order ID values. 
First, select the order ID column.
Click the Home tab. Under the Styles panel, select the option Conditional Formatting. From the drop-down menu, hover the mouse over 
Highlight Sales Rules and select Duplicate Values.

A Duplicate Values dialog box appears. Select the formatting style from the drop-down menu. In our example,
we will choose Green Fill with Dark Green Text. Click OK.

we can see that the conditional formatting is applied to the column order ID. Excel highlights all the duplicate cells
with Green Fill and Dark Green Text.

We can also explore other options available in conditional formatting, like greater than, less than, between, equal to,
texts that contains, a date occurring, and top slash bottom rules. All these rules work in the similar format.

Excel provides predefined styles to quickly apply conditional formatting to our data. They are data bars. Data bars are horizontal 
bars added to each column, much like a bar graph.
Color scales. Color scales change the color of each cell based on its value. Each color scale uses two or three color gradients.
Icon set. Icon sets add specific icons to each cell based on its value.

Another example to explain how icon set rules are used.
Consider the given sales table here on the basis of the sales amount. We want to apply the icon set rule. If the sales amount 
is greater than 8,000, then a green arrow should appear in the upward direction. If the sales amount is between 5,000 and 8,000,
then show a yellow arrow in the horizontal direction. If the sales amount is less than 5,000, then show a red arrow in the downward 
direction. To perform conditional formatting, select the desired cells.
Click on the Home tab. Under the Styles panel, select the option Conditional Formatting. From the drop-down menu, hover the mouse 
over the icon set rules and select the first rule. Again, click on Conditional Formatting. Select the option Manage Rules from the
drop-down.

A Conditional Formatting Rules Manager dialog box appears.
Go to Icon Set Rule and select the three-icon set rule. Click on Edit Rule and an Edit Rule Formatting dialog box appears. 
By default, for three-icon set rule, Excel uses the 67th percentile and the 33th percentile rule. This means that it shows a 
green arrow for values greater than 67%, yellow arrows for values between 67 and 33%, and red arrow for values less than 33%. 
Now let us customize this rule for our criteria. In the Type drop-down, select the option as Number.
In the Value reference box, enter value as 8,000 for green color arrow and 5,000 for yellow color arrow. Excel automatically picks the criteria for the red color arrow. Click OK. In the Conditional Formatting Rules Manager window, click OK. Cells which have a value greater than 8,000 have a green arrow in the upward direction. Values between 5K and 8K are highlighted with a yellow arrow and values less than 5K are highlighted with a red arrow.

Example for conditional formatting. We can also apply the conditional formatting rule with the help of formulas. Consider 
the given table, which shows the profit done by each salesman. Here, we want to highlight the rows in the table wherever profit 
is greater than 4000. Select the entire table along with headings.
Click on Conditional Formatting. Select the option, New Rule from the drop-down. A new Formatting Rule dialog box appears. 
Under Select Rule Type, select the option Use a Formula to determine which sales to format. Under Format Values reference box, 
enter the formula as, equals if open bracket $H2 greater than 4000, true, false, close bracket. This will apply formatting to a 
sale if the profit is greater than 4000. Click on the Format button from the Format Sales dialog box. Select the Fill tab. 
From the Color dialog box, select the color as green. Finally, click OK. The conditional formatting is successfully applied to the 
sales. Here, we can see that the sales with the profit greater than 4000 are highlighted with the green color.


Logical functions.
Logical functions evaluate a cell or cells for a criteria and return a Boolean value, true or false. In this topic, 
we will cover various logical functions like if, and, or, not, true, false. Consider the given sales table. 
Here on the basis of the sales amount, we want to determine the commission percentage of each salesman. Following is the criteria.

If net sales greater than or equal to 10,000 set commission is 5%. If net sales greater than or equal to 5,000 and less than or 
equal to 10,000 set commission is 2.5%. If net sales less than 5,000 set commission as 1.5%, this is a common condition where we're
required to create a between formula that picks all values between the two given values. In such conditions, we use if, with the, 
and function. Let's write the formula in cell I5. Like any other formula, we will start with the equal sign, then type the function 
name, that is if, and then type an open parentheses. The first parameter we need to pass is a logical test. Here, the logical 
test is if sales cell G5 greater than or equal to 10,000, assign the value as 5%. Then we will pass the second logical test.
Here we will use in function. If open bracket and open bracket sale cell G5 greater than or equal to 5,000 comma cell G5 less than 
or equal to 10,000 comma assigned value is 2.5%. In the else parameter, we will type 1.5%. This means that if the first two cases
become false, then the formula will assign the value 1.5. Finally close the two braces for the two ifs. Thus Excel returns the 
result is 2.5% for cell G5. Now drag the formula with the help of the fill handle. We can see the results for the other cells as well. 
The or function returns true if any of the conditions are true and returns false if all of the conditions are false. In the given table,
we are required to assign performance remarks for each salesman as per the scaling table. In the scaling table, we have the criteria 
that if net sales is greater than 10,000 or profit is greater than 5,000 set remarks as good else set remark as needs improvement.
Let's write the formula using if and or to check sales and maximum sales in cell J5. So our formula becomes equals if open bracket 
or open bracket G5 greater than 10,000 comma H5 greater than or equal to 5,000 comma double quote good double quote comma double 
quote need improvement double quote close bracket. Let's drag this formula across the cells with the help of the fill handle.
This formula returns true if any of the conditions is true. Thus in the given example, the cell J9 returns good even if profit is 
less than 5,000. Our next function is true slash false. True slash false returns true and false respectively if we write them in any 
cell.

The not function reverses the result of the function. If result is true, it returns false else true. Let's write the formula is 
equal not open brackets K5 close bracket in cell L5. This returns the result is false.

Let us now study the different lookup and reference functions used in Excel, such as VLOOKUP, HLOOKUP, MATCH, INDEX, and OFFSET
function. The VLOOKUP function lets us search for specific information in the current worksheet. Say we have a list of students 
with marks. We can search for the marks of a specific student. If our table is in horizontal format and we want to determine a
specific value, then we use the HLOOKUP function.

VLOOKUP function
Consider the extract from our master sales table. The table depicts sales information
based on order ID, products sold, salesmen and net sales. Now we want to determine the net sales corresponding to order 
ID 1, 1, 2, 1. Let's understand how we can accomplish this using the VLOOKUP function. Note that the VLOOKUP function is only 
used for vertical tables. Let's use cell I2 to add the formula. Like any other formula, we will start with the equal sign, then 
type our function name VLOOKUP and then type an open parentheses. Now we will add the arguments. The first argument is lookup value. 
Lookup value corresponds to the value or item we are searching for. So in our example, it will be order ID 1, 1, 2, 1, cell H2. 
The second argument is table array. Select the column order ID to net sales. Table array is the cell range that contains the data.
In this example, our data is in cell B2, 2, E40. The third argument is called colindexNum, column index number. The column index
number is the column number in which we are looking for information. Here in our table array, net sales are the fourth column. 
So our third argument will be 4. The fourth argument is range lookup. This value corresponds. If we are looking for approximate matches or not and can have value either true or false, true denotes the approximate match and false denotes the exact match. Here, we will pass false. Finally close the parentheses. So our function has the form equal VLOOKUP, H2, B2, E40, 4, false, close bracket. We can see that the function returns the value as 2, 2, 7, 7. Note that the VLOOKUP function works from left to right. That means the lookup value should always be present in the leftmost column of our table array.

HLOOKUP function.
If our table is in horizontal format and we want to determine a specific value, then we use the HLOOKUP function. 
Consider the given table. Let's write the formula in cell I4. We will start with the equal sign, then type our function name,
HLOOKUP, and then type open parentheses. The first argument is the lookup value. So in our example, it will be order 
ID equals 1, 1, 2, 1, cell H4. The second argument is table array. In this example, our data is in cell G8, 2, AS11.
The third argument is row index number. Here in our table array, net sales is the fourth row. So our third argument will be 4.
The fourth argument is range lookup. Here we will pass false, finally close the parentheses. So our function has the form equals
HLOOKUP, open bracket, H4, G8, AS11, 4, false, close bracket. The function returns the value as 2277. Note that the HLOOKUP function
works from top to bottom. That means the lookup value should always be in the topmost row of your table array.

Match function
The match function searches for a specified value in an item in a single dimensional array and then returns the relative 
position of that item in the array. Let us understand its functioning with the help of an example. Consider the given sales 
table shown. Here we want to determine the position of the corresponding date in the original table. So let's write the 
formula in cell E5. Type equals sign, then type the function name match and open parentheses.

The first argument is the lookup value. So in our example, it will be the date in cell B5.
The second argument is lookup array. The lookup array is a range of cells that contains the value we are searching for. In this example, 
we will select the cells B17, 2, B1, 3, 4, 2,
3. The third argument is match type. A match type can be either minus 1, 0, or 1. The value should be 1 if we want to find the 
largest value less than or equal to the lookup value. The value should be 0 if we want to find the first value exactly equal to
the lookup value. The value should be minus 1 if we want to find the smallest value greater than or equal to lookup value. 
Here, we will pass the match type as 0 as we require an exact match.
Finally, close the parentheses. So our function should look like match, open bracket, B5, comma, dollar sign B, dollar sign 17, 
colon, dollar sign B, dollar sign 1, 3, 4, 2, comma, 0, close bracket. This returns the value as 3. Now we can drag the formula
across cells with the help of the fill handle. Similarly, we can use the match formula in cell E3 to determine the position of 
the shown field name cell C3 in range B17, 2, I17. For example, net sales is at seventh position in the range B17, 2, I17. 
Let's write the function in cell E3. Write the formula as equal sign match and open parentheses. In the first argument, select cell C3.

For second argument, select cells B17, 2, I17. Pass third argument as 0. Finally, close the parentheses. So our function looks
like equal match, open bracket, C3, comma, dollar sign B, dollar sign 17, colon, dollar sign I, dollar sign 17, comma, 0, close bracket.
So for the profit loss field, the value returned is 8. And for net sale, the value returned is 7.

Index and offset functions
The index function returns value from a specified position in a specific column in a list. Suppose we want to determine the value 
of the field mentioned in cell C3 from the sales table on a specified date. The table should dynamically fetch the value if the 
value of the cell C3 has changed. If we enter profit loss, formulas should fetch the profit loss value for the specified date. 
If we write net sales and cell C3, then the formula should fetch net sales value for a specified date. So let's use the index 
function to determine the value in this worksheet. Select cell C5, write formula is equal sign index, and open parentheses. 
The first argument is the array. For our example, enter B17, colon I1, 3, 4, 2. The second argument is the row num. 
This corresponds to the row number that has the value we want to return. Here we will enter E5, which denotes the required date. 
The third argument is column number. This corresponds to the column number that has the value we want to return. Here we will enter 
E3, which denotes the position of the field name in cell C3 in the table. Finally close the parentheses. Thus our formula returns the 
value is 6,528 based on the position at cell Z5. This is the net sales value on the date, the 2nd of January. Now drag the formula with
the fill handle to the other cells as well. The offset function returns a reference to a range that is the offset number of the rows 
and columns from another range or cell. Now let's understand how to use it. Select cell D5, write formula is equal sign offset, 
and open parentheses. The first argument is the reference. This denotes the starting range from which the offset will be applied.
For our example, we will select the reference cell as B17. The second argument is the rows. This denotes the number of rows to apply 
as the offset to the reference. This can be a positive or a negative number. So for our example, we will enter E5-1. 
Here we are subtracting one to match the number of rows, which have the value and the offset from the reference cell. 
The third argument is the coals. This corresponds to the column number that has the value we want to return here. We will enter E3,
which denotes a position at the field name and subtract by one to match with the offset referencing. Finally close the parentheses. 
The function returns the value based on the position of date from cell B5 and field from cell C3. Now drag the formula across the
cells with the help of the fill handle. If we enter a profit loss, the formula should fetch the profit loss value for the specified date.

Statistical Functions

A variety of statistical functions are available in Excel to perform calculations ranging from basic function, mean, median, and mode, 
to more composite distribution and test, binomial, or chi-square.
we will cover various statistical functions like sumifs, countifs, percentile, quartiles, standard deviation, and median.


SUMIFS function. SUMIFS and COUNTIFS are the most frequently used functions in Excel. These functions allow us to perform count 
and sum based on one or more criteria. The SUMIFS function calculates the sum of cells based on certain criteria. Let's understand
how to use the function with the help of an example.
Consider the given sales table. Say we want to determine the net sales done by salesman Justin. Here we will use the 
SUMIFS function to calculate net sales. So let's write the formula in cell N4.
Type equals sign, then type the function name SUMIFS and then type an open parentheses.

The first argument is the sum range. This is the input range that contains the required data.
So, in our example, we will select cells H3 to H1328. The second argument is the criteria range. This denotes the range that
contains the required criteria. Here, we'll pass the range that holds salesman's name cells E3D1328.

The third argument is criteria. This corresponds to our required criteria. We only require net sales of the salesman, Justin. 
So, we will select cell M4. Finally, close the parentheses. Note that we can pass multiple criteria in this function.
The function returns the net sales done by Justin.

Example of COUNTIFS function
COUNTIFS function is similar to the SUMIFS function. It counts the number of cells in a given range when certain criteria is met.
Say in the given sales table, we want to determine the total number of sales for net sales greater than 8000. To determine the count
we will use the COUNTIFS function. So let's write the formula in cell n5. Type the equal sign then type the function name COUNTIFS 
and then type an open parentheses. The first argument is the criteria range 1. This denotes the range that contains the required 
criteria. Here we will pass the cells containing net sales h3 to h1328.

The second argument is criteria 1. This corresponds to our required criteria. We only require entries with net sales greater than 8000.
So we will enter greater than 8000. Finally close the parentheses. Note that the function allows you to enter multiple criteria.
So m5 reflects the total number of sales as 445 for net sales greater than 8000.

percentile and quartiles in Excel.

Consider the given sales table. Let's see how to use the percentile function on net sales to find its 40th percentile. Select the cell n6, 
write the formula as equals sign percentile, open bracket. Select the column net sales h3. 2, h1328 is our first argument.
Pass the second argument as 0.4 in order to find the 40th percentile.
This returns the result 5220. This means that 40% of the net sales is less than or equal to 5220. The next function is quartile. 
Quartile function depicts the results for the first, second, third, and fourth quartile. Say we want to find the total number of
sales which are less than or equal to 25%. Let's use the quartile function to calculate this. Select cell n7 to write the formula. 
Type equals sign function name is quartile and open braces. Select net sales column h3 to h1328 is the first argument. 
Type 1 is the second argument. The second argument must be a number between 0 and 4. The function returns the value is 3822, 
which means that 25% of the sale is less than or equal to 3822. Note that here we can use the percentile function to perform 
the same task. The function percentile h3 to h1328, 0.25 gives us the same result. It's up to us which function we would 
like to use for the quartiles.


Standard deviation, median, and rank function
Excel has a function to calculate sample standard deviations, STDEV. Standard deviation determines how dispersed the data is
from the mean. Say we want to calculate the standard deviation for a number of customers. So write the formula in cell, N8, 
as equals the function name, STDEV, open braces. Select number of customers columns as its argument. The function returns 
a result, 1.4. The median function returns the value from the range. For example, we want to find the mid value for net sales to 
calculate median in cell, N9. Write the formula as equals sign the function name, median, then open braces, select net sales
column as its argument. This calculates the mid value of net sales as 6,192. Rank function is used to compare a number from the 
rest of the numbers in list in any order, whether ascending or descending. This function returns the rank of the number relative
to the other values in the list. Let's use rank function in cell J4 to calculate rank on the basis of net sales. Select cell J4
and write the formula as equals sign, then type the function name, rank, and then type an open parentheses. The first argument is 
the number. This is the value whose rank we are required to calculate. Here we will pass the argument cell H4. The second argument 
is ref. This corresponds to the array or reference list. Here we will select the column net sales. That is cells H4 to H1,328.
The third number is order. This specifies how to rank the number. Zero means descending order and one denotes ascending order. 
This argument is optional. If we don't pass any argument, Excel automatically takes the argument zero. Here we will pass the zero.
Finally close the parentheses. Here we can see that Excel has determined the rank per net sales 7,164 as 553. Finally, we can drag 
the formula and can see the rank for the other cells based on net sales.


custom and conditional formatting, use logical, statistical, and lookup functions. 
Let's do a small exercise to reinforce the concepts learned. We will provide you a step-by-step assistance to do this exercise.
Let's start working on this together. Consider the given shared stock price data of various companies across different years. 
You are required to calculate the stock price in cell C6 for company Infosys for the year 2012. Use offset and match function.

Let us consider the given data of stock prices of various companies across different years. Now calculate the stock price of 
cell C6 for Infosys in the year 2012 using offset and match functions. To do this, let us first open the file stockprices.xlsx. 
Now select cell C6. In the next step, type equals offset in the cell to get Infosys price in 2012, next select B9 as the first 
parameter. Now type match B4, B10 to B14 as the second parameter. Finally type match C4, C9 to G9 as the third parameter.

Question 1
Which of the following features in Excel allows you to highlight cells based on specific rules such as duplicate values or 
cells greater than a given number?  
A: Conditional formatting

Question 2
Which Excel function returns TRUE if either of the logical conditions is true?   
A: OR

Question 3
Which function is most suitable to retrieve data from a specific row in a horizontal table?   
A: HLOOKUP

Question 4
Which Excel statistical function is used to find the middle value in a dataset?
A: MEDIAN

Question 5
Which Excel function would you use to add values that meet multiple criteria? 
A: SUMIFS
